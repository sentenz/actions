# Trivy Configuration File
#
# This is a sample configuration file for Trivy. Place this file as `trivy.yaml`
# in your repository root to customize Trivy's behavior.
#
# Order of precedence:
# 1. CLI flags (highest priority) - passed via action inputs
# 2. Environment variables
# 3. This config file
# 4. Default values (lowest priority)
#
# See: https://aquasecurity.github.io/trivy/latest/docs/configuration/

# Database configuration
db:
  skip-update: false
  repository:
    - mirror.gcr.io/aquasec/trivy-db:2
    - ghcr.io/aquasecurity/trivy-db:2

# Cache configuration
cache:
  backend: fs

# Scan configuration
scan:
  scanners:
    - vuln
    - secret
  parallel: 5
  skip-dirs: []
  skip-files: []

# Severity levels to report
severity:
  - UNKNOWN
  - LOW
  - MEDIUM
  - HIGH
  - CRITICAL

# Vulnerability configuration
vulnerability:
  ignore-unfixed: false

# License configuration
license:
  confidencelevel: 0.9
  full: false
  ignored: []

# Misconfiguration scanning
misconfiguration:
  scanners:
    - azure-arm
    - cloudformation
    - dockerfile
    - helm
    - kubernetes
    - terraform
    - terraformplan-json
    - terraformplan-snapshot

# Output configuration
format: json
timeout: 5m0s
exit-code: 0

# Ignore file
ignorefile: .trivyignore
